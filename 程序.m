%% 其实就是求解一个运输问题
clc
clear
% 供应土方量
supply=[30042 76104 56974 23371 13895 6127 6750 8963 32276 16308 7986 1661 82090 451 8473 695 7 82948];
% 需求土方量
demand = [7601 ,0, 0 ,1024 ,26667 ,12462 ,5631 ,987 ,30544,23630,25128,43735,28502,27046,9710,87010,73871,46059];
% 运输成本矩阵
% cost = [48 164 289 319 360 376 404 466 198 252 288 364 584 893 923 699 857 586 0
%     207 0 79 260 345 252 327 404 278 253 229 306 521 834 866 645 779 547 0
%     296 79 0 170 513 425 434 486 357 268 170 220 416 741 745 458 633 227 0
%     452 75 346 63 640 565 484 334 440 360 263 172 359 628 674 448 629 175  0
%     417 414 493 531 58 89 195 252 204 179 273 359 498 796 864 617 774 595  0
%     378 306 322 399 112 54 84 159 177 121 190 251 426 676 735 517 685 570  0
%     462 423 341 398 193 131 70 108 273 199 214 208 446 642 667 437 595 595 0
%     529 507 430 294 269 194 115 68 347 244 191 166 278 566 581 353 529 510 0
%     97 133 207 283 174 215 252 315 86 120 172 243 536 828 875 620 790 575 0
%     151 97 127 187 217 155 203 247 130 86 104 168 518 778 709 487 671 308 0
%     218 136 85 118 282 223 212 172 196 124 85 99 387 641 623 402 557 249 0
%     252 156 84 52 394 286 213 175 244 161 110 85 275 564 578 340 506 241 0
%     580 492 390 280 427 398 283 164 405 318 283 206 142 309 473 153 358 553 0
%     839 736 665 552 799 737 667 516 766 678 625 497 300 45 276 208 145 814 0
%     896 775 714 555 790 696 609 531 790 706 650 520 327 204 46 206 101 718 0
%     580 490 420 288 482 370 300 216 465 375 335 218 228 275 363 94 283 545 0
%     871 736 635 508 736 630 563 480 734 646 638 475 179 105 103 175 0 755 0
%     440 339 169 202 603 497 422 403 493 405 314 316 465 787 801 537 695 110 0
% 
%     ];
cost = [48 164 289 319 360 376 404 466 198 252 288 364 584 893 923 699 857 586 
    207 0 79 260 345 252 327 404 278 253 229 306 521 834 866 645 779 547 
    296 79 0 170 513 425 434 486 357 268 170 220 416 741 745 458 633 227 
    452 75 346 63 640 565 484 334 440 360 263 172 359 628 674 448 629 175  
    417 414 493 531 58 89 195 252 204 179 273 359 498 796 864 617 774 595  
    378 306 322 399 112 54 84 159 177 121 190 251 426 676 735 517 685 570  
    462 423 341 398 193 131 70 108 273 199 214 208 446 642 667 437 595 595 
    529 507 430 294 269 194 115 68 347 244 191 166 278 566 581 353 529 510 
    97 133 207 283 174 215 252 315 86 120 172 243 536 828 875 620 790 575 
    151 97 127 187 217 155 203 247 130 86 104 168 518 778 709 487 671 308 
    218 136 85 118 282 223 212 172 196 124 85 99 387 641 623 402 557 249 
    252 156 84 52 394 286 213 175 244 161 110 85 275 564 578 340 506 241 
    580 492 390 280 427 398 283 164 405 318 283 206 142 309 473 153 358 553 
    839 736 665 552 799 737 667 516 766 678 625 497 300 45 276 208 145 814 
    896 775 714 555 790 696 609 531 790 706 650 520 327 204 46 206 101 718 
    580 490 420 288 482 370 300 216 465 375 335 218 228 275 363 94 283 545 
    871 736 635 508 736 630 563 480 734 646 638 475 179 105 103 175 0 755 
    440 339 169 202 603 497 422 403 493 405 314 316 465 787 801 537 695 110 

    ];
B2 = [];
for i =1:1:18
    
    A1 = zeros(18,18);
    A1(:,i)=1;
    B1 = reshape(A1',1,[]);
    B2 = [B2,B1]
    %B3 = [B2,B1]
    %B2 = B3
end

B_END = reshape(B2,[324,18]);
B_END =B_END'






%% 定义线性规划模型
num_sources = 18;
num_destinations = 18;
f = [reshape(cost',1,num_sources*num_destinations)]';
Aeq = [
    kron(eye(num_sources),ones(1,num_destinations));
    % B_END

];% 等式约束矩阵
Beq = [demand';
    ] ;
A = B_END;%不等式约束矩阵
b = supply';%不等式约束右侧向量
lb = zeros(size(f));
ub = inf(size(f));
[x,fval] = linprog(f,A,b,Aeq,Beq,lb,ub);

